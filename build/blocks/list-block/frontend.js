(()=>{"use strict";document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector(".feedback-list"),t=document.querySelector(".feedback-pagination"),n=document.querySelector(".feedback-detail");let a=1;const o=(t=1)=>{const n=new FormData;n.append("action","get_feedback_entries"),n.append("nonce",FeedbackAjax.nonce),n.append("page",t),fetch(FeedbackAjax.ajax_url,{method:"POST",credentials:"same-origin",body:n}).then((e=>e.json())).then((t=>{t.success?(a=t.data.current_page,s(t.data.entries),c(t.data.current_page,t.data.per_page,t.data.total)):e.innerHTML=`<p>${t.data.message}</p>`})).catch((e=>{console.error("Wystąpił błąd:",e)}))},d=(e,t,n=!1,a="")=>{const o=document.createElement("div");return o.setAttribute("role","button"),o.setAttribute("tabindex",n?"-1":"0"),o.textContent=e,a&&(o.className=a),n?(o.setAttribute("aria-disabled","true"),o.classList.add("disabled")):(o.addEventListener("click",t),o.addEventListener("keydown",(e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),t())}))),o},s=t=>{e.innerHTML="",t.forEach((t=>{const n=document.createElement("li");n.className="feedback-tile";const a=document.createElement("div");a.className="tile-row tile-row-name",a.textContent=`${t.first_name} ${t.last_name}`,n.appendChild(a);const o=document.createElement("div");o.className="tile-row tile-row-email",o.textContent=t.email,n.appendChild(o);const s=document.createElement("div");s.className="tile-row tile-row-subject",s.textContent=t.subject,n.appendChild(s);const c=d("Pokaż całą wiadomość",(()=>i(t.id)),!1,"tile-row tile-row-button");n.appendChild(c),e.appendChild(n)}))},c=(e,n,a)=>{t.innerHTML="";const s=Math.ceil(a/n),c=e>=s,i=d("Poprzedni",(()=>o(e-1)),e<=1),r=d("Następny",(()=>o(e+1)),c);t.appendChild(i),t.appendChild(r)},i=e=>{const t=new FormData;t.append("action","get_feedback_detail"),t.append("nonce",FeedbackAjax.nonce),t.append("entry_id",e),fetch(FeedbackAjax.ajax_url,{method:"POST",credentials:"same-origin",body:t}).then((e=>e.json())).then((e=>{e.success?r(e.data):n.innerHTML=`<p>${e.data.message}</p>`})).catch((()=>{n.innerHTML=`<p>${__("Wystąpił błąd. Spróbuj ponownie.","custom-form-review")}</p>`}))},r=e=>{n.innerHTML=`\n\t\t\t<h3>Szczegóły wiadomości</h3>\n\t\t\t<p><strong>Imię i Nazwisko:</strong> ${e.first_name} ${e.last_name}</p>\n\t\t\t<p><strong>Email:</strong> ${e.email}</p>\n\t\t\t<p><strong>Temat:</strong> ${e.subject}</p>\n\t\t\t<p><strong>Wiadomość:</strong> ${e.message}</p>\n\t\t`,n.style.border="1px solid"};o(1)}))})();